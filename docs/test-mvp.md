# 测试与验收清单（MVP）

## A. 买家端
- 金额校验：当出价低于最低比例时，提交被阻止并提示
- 条款勾选：未勾选无法提交
- 创建定金：能成功拿到 client_secret 并完成支付
- 支付失败：显示可重试的错误提示
- 成功后：显示“已收到定金”的成功页面/提示

## B. 商家端
- 列表过滤：仅展示 deposit_status=succeeded 的出价
- 接受出价：生成尾款 PaymentIntent，返回支付信息
- 拒绝出价：定金退款成功，状态更新为 refunded + rejected
- 状态展示：定金已付/已退、尾款待付/已付 标签准确

## C. 数据一致性
- offers 写入：deposit_pi_id、deposit_status、final_pi_id、final_status 字段按流程更新
- payments 记录：定金成功、定金退款、尾款成功均有流水
- 幂等：重复点击接受/拒绝不会造成重复创建/重复退款（通过后端幂等校验）

## D. 安全与限制
- 鉴权：商家端接口需要商家身份；买家仅能创建定金
- 速率限制：同邮箱对同表单短时间内重复出价受限（可后补）
- 隐私：买家邮箱不在公开页面展示（仅商家可见）

## E. 手工验收路径
1. 创建表单：配置 min_bid_ratio=60, deposit_percentage=10
2. 买家 A 出价等于底线 → 成功支付定金
3. 买家 B 出价低于底线 → 被前端拦截
4. 商家在 Dashboard 看到 A → “接受”，生成尾款 → 买家完成支付 → 订单完成
5. 商家对另一条出价“拒绝” → 定金退款 → 状态更新